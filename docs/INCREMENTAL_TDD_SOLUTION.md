# ğŸ¯ å®Œå…¨å¢é‡çš„æµ‹è¯•é©±åŠ¨æ‰©å±•è§£å†³æ–¹æ¡ˆ

## âœ¨ è§£å†³æ–¹æ¡ˆæ¦‚è¿°

æˆ‘ä¸ºæ‚¨çš„ CentralizedAgentFramework è®¾è®¡äº†ä¸€ä¸ª**å®Œå…¨å¢é‡ã€é›¶å½±å“**çš„æµ‹è¯•é©±åŠ¨å¼€å‘æ‰©å±•ï¼Œå®ç°äº†æ‚¨è¦æ±‚çš„æ‰€æœ‰åŠŸèƒ½ï¼š

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°

1. **âœ… ç”¨æˆ·æŒ‡å®šæµ‹è¯•å°è·¯å¾„æ”¯æŒ**
2. **âœ… æµ‹è¯•å¤±è´¥è‡ªåŠ¨è¿­ä»£åˆ†æä¼˜åŒ–**  
3. **âœ… æ™ºèƒ½é”™è¯¯åˆ†æå’Œä¿®å¤å»ºè®®**
4. **âœ… å®Œå…¨é›¶å½±å“çš„å¢é‡å®ç°**

## ğŸ—ï¸ æ¶æ„ç‰¹ç‚¹

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

| åŸåˆ™ | å®ç°æ–¹å¼ | ä¿è¯ |
|------|----------|------|
| **å®Œå…¨å¢é‡** | ç‹¬ç«‹çš„ `extensions/` æ¨¡å— | ä¸ä¿®æ”¹ä»»ä½•ç°æœ‰æ–‡ä»¶ |
| **é›¶å½±å“** | è£…é¥°å™¨æ¨¡å¼åŒ…è£…ç°æœ‰åè°ƒå™¨ | ç°æœ‰åŠŸèƒ½å®Œå…¨ä¸å˜ |
| **å‘åå…¼å®¹** | ä»£ç†æ‰€æœ‰ç°æœ‰æ–¹æ³• | æ‰€æœ‰ç°æœ‰APIä¿æŒç›¸åŒ |
| **å¯é€‰ä½¿ç”¨** | æŒ‰éœ€å¯ç”¨æ–°åŠŸèƒ½ | ä¸å¼ºåˆ¶å‡çº§ |

### è£…é¥°å™¨æ¨¡å¼æ¶æ„

```
æ‚¨çš„ç°æœ‰ä»£ç  (å®Œå…¨ä¸å˜)
       â†“
CentralizedCoordinator  â†â”€â”€ ä¸ä¿®æ”¹
       â†“ åŒ…è£…/è£…é¥°
TestDrivenCoordinator   â†â”€â”€ æ–°å¢æ‰©å±•
       â†“
ç°æœ‰åŠŸèƒ½ + æµ‹è¯•é©±åŠ¨åŠŸèƒ½
```

## ğŸ“ æ‰©å±•æ¨¡å—ç»“æ„

```
extensions/                           # æ–°å¢ç›®å½•
â”œâ”€â”€ __init__.py                      # æ‰©å±•å…¥å£
â”œâ”€â”€ test_driven_coordinator.py       # ä¸»åè°ƒå™¨æ‰©å±•
â”œâ”€â”€ enhanced_task_parser.py          # æ™ºèƒ½ä»»åŠ¡è§£æ
â”œâ”€â”€ test_analyzer.py                 # æµ‹è¯•åˆ†æå™¨
â””â”€â”€ README.md                        # è¯¦ç»†æ–‡æ¡£
```

**å…³é”®ï¼šæ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ–°å¢çš„ï¼Œæ²¡æœ‰ä¿®æ”¹ä»»ä½•ç°æœ‰æ–‡ä»¶ï¼**

## ğŸš€ ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šæœ€ç®€å•é›†æˆï¼ˆä¸€è¡Œä»£ç ï¼‰

```python
# ç°æœ‰ä»£ç ï¼ˆå®Œå…¨ä¸å˜ï¼‰
coordinator = CentralizedCoordinator(config)
coordinator.register_agent(verilog_agent)
coordinator.register_agent(reviewer_agent)

# å‡çº§ä¸ºæµ‹è¯•é©±åŠ¨åŠŸèƒ½ï¼ˆä¸€è¡Œä»£ç ï¼‰
from extensions import create_test_driven_coordinator
enhanced_coordinator = create_test_driven_coordinator(coordinator)

# ç°æœ‰åŠŸèƒ½å®Œå…¨ä¸å˜
result = await enhanced_coordinator.coordinate_task_execution(task)

# æ–°å¢æµ‹è¯•é©±åŠ¨åŠŸèƒ½
tdd_result = await enhanced_coordinator.execute_test_driven_task(
    task_description="è®¾è®¡32ä½ALU...",
    testbench_path="/path/to/alu_tb.v"
)
```

### æ–¹å¼2ï¼šè‡ªå®šä¹‰é…ç½®

```python
from extensions import TestDrivenConfig, TestDrivenCoordinator

# è‡ªå®šä¹‰é…ç½®
config = TestDrivenConfig(
    max_iterations=3,           # æœ€å¤§è¿­ä»£æ¬¡æ•°
    enable_deep_analysis=True,  # æ·±åº¦é”™è¯¯åˆ†æ
    timeout_per_iteration=300   # æ¯æ¬¡è¿­ä»£è¶…æ—¶
)

# åˆ›å»ºæ‰©å±•åè°ƒå™¨
tdd_coordinator = TestDrivenCoordinator(your_coordinator, config)
```

## ğŸ”„ æµ‹è¯•é©±åŠ¨å·¥ä½œæµç¨‹

```
ç”¨æˆ·è¾“å…¥: "è®¾è®¡éœ€æ±‚ + æµ‹è¯•å°è·¯å¾„"
              â†“
    è‡ªåŠ¨æ£€æµ‹ä»»åŠ¡ç±»å‹
              â†“
    æ ‡å‡†ä»»åŠ¡ â†’ ä½¿ç”¨åŸæœ‰æµç¨‹ï¼ˆä¸å˜ï¼‰
              â†“
    æµ‹è¯•é©±åŠ¨ä»»åŠ¡ â†’ å¯ç”¨æ–°åŠŸèƒ½
              â†“
         éªŒè¯æµ‹è¯•å°æ–‡ä»¶
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      è¿­ä»£å¾ªç¯ï¼ˆæœ€å¤š5æ¬¡ï¼‰      â”‚
    â”‚                           â”‚
    â”‚  ç¬¬Næ¬¡è¿­ä»£ï¼š                â”‚
    â”‚  1. ğŸ¨ è®¾è®¡é˜¶æ®µï¼šç”Ÿæˆ/æ”¹è¿›è®¾è®¡ â”‚
    â”‚  2. ğŸ§ª æµ‹è¯•é˜¶æ®µï¼šè¿è¡Œç”¨æˆ·æµ‹è¯•å° â”‚
    â”‚  3. ğŸ” åˆ†æé˜¶æ®µï¼šæ™ºèƒ½é”™è¯¯åˆ†æ  â”‚
    â”‚                           â”‚
    â”‚  âœ… æµ‹è¯•é€šè¿‡ â†’ æˆåŠŸå®Œæˆ      â”‚
    â”‚  âŒ æµ‹è¯•å¤±è´¥ â†’ ç»§ç»­è¿­ä»£      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
    è¿”å›å®Œæ•´ç»“æœå’Œè¿­ä»£å†å²
```

## ğŸ¯ æ™ºèƒ½åŠŸèƒ½ç‰¹æ€§

### 1. è‡ªåŠ¨ä»»åŠ¡ç±»å‹è¯†åˆ«

ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ä»¥ä¸‹æƒ…å†µä¸ºæµ‹è¯•é©±åŠ¨ä»»åŠ¡ï¼š

- âœ… æ˜¾å¼æä¾›æµ‹è¯•å°è·¯å¾„å‚æ•°
- âœ… ä»»åŠ¡æè¿°åŒ…å«æµ‹è¯•å°è·¯å¾„
- âœ… åŒ…å«TDDå…³é”®è¯ï¼ˆæµ‹è¯•å°ã€è¿­ä»£ã€ä¼˜åŒ–ç­‰ï¼‰

### 2. æ™ºèƒ½æµ‹è¯•å°éªŒè¯

```python
# è‡ªåŠ¨éªŒè¯æµ‹è¯•å°æ–‡ä»¶
validation_checks = {
    "has_module": True,           # æœ‰moduleå£°æ˜
    "has_endmodule": True,        # æœ‰endmoduleç»“å°¾  
    "has_initial_block": True,    # æœ‰æµ‹è¯•é€»è¾‘
    "has_testbench_elements": True, # æœ‰æµ‹è¯•å°å…ƒç´ 
    "syntax_check": True          # åŸºæœ¬è¯­æ³•æ£€æŸ¥
}
```

### 3. æ·±åº¦é”™è¯¯åˆ†æ

| é”™è¯¯ç±»å‹ | åˆ†æèƒ½åŠ› | ä¿®å¤å»ºè®® |
|----------|----------|----------|
| **ç¼–è¯‘é”™è¯¯** | è¯­æ³•é”™è¯¯ã€ç«¯å£ä¸åŒ¹é…ã€æ¨¡å—æœªæ‰¾åˆ° | å…·ä½“çš„ä»£ç ä¿®æ”¹å»ºè®® |
| **è¿è¡Œæ—¶é”™è¯¯** | ä¿¡å·çŠ¶æ€ã€æ—¶åºé—®é¢˜ã€æ— é™å¾ªç¯ | æµ‹è¯•å°ä¼˜åŒ–å»ºè®® |
| **æµ‹è¯•å¤±è´¥** | é€»è¾‘é”™è¯¯ã€åŠŸèƒ½ä¸åŒ¹é… | è®¾è®¡æ”¹è¿›æ–¹å‘ |

### 4. è‡ªåŠ¨è¿­ä»£ä¼˜åŒ–

- **æœ€å¤š5æ¬¡è¿­ä»£**ï¼ˆå¯é…ç½®ï¼‰
- **æ™ºèƒ½å¤±è´¥åˆ†æ**ï¼šæ¯æ¬¡å¤±è´¥åæ·±åº¦åˆ†æåŸå› 
- **é’ˆå¯¹æ€§æ”¹è¿›**ï¼šåŸºäºå¤±è´¥ç±»å‹ç”Ÿæˆå…·ä½“å»ºè®®
- **å®Œæ•´è¿½æº¯**ï¼šä¿å­˜æ¯æ¬¡è¿­ä»£çš„è¯¦ç»†è®°å½•

## ğŸ“Š API å‚è€ƒ

### ä¸»è¦æ–¹æ³•

#### `execute_test_driven_task(task_description, testbench_path=None, context=None)`

**åŠŸèƒ½**: æ‰§è¡Œæµ‹è¯•é©±åŠ¨ä»»åŠ¡çš„ä¸»å…¥å£

**å‚æ•°**:
- `task_description` (str): è®¾è®¡éœ€æ±‚æè¿°
- `testbench_path` (str, å¯é€‰): æµ‹è¯•å°æ–‡ä»¶è·¯å¾„
- `context` (dict, å¯é€‰): é¢å¤–ä¸Šä¸‹æ–‡ä¿¡æ¯

**è¿”å›**:
```python
{
    "success": bool,              # æ˜¯å¦æˆåŠŸ
    "session_id": str,            # ä¼šè¯ID
    "total_iterations": int,      # æ€»è¿­ä»£æ¬¡æ•°
    "final_design": [...],        # æœ€ç»ˆè®¾è®¡æ–‡ä»¶
    "completion_reason": str,     # å®ŒæˆåŸå› 
    "error": str                  # é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœå¤±è´¥ï¼‰
}
```

#### å…¼å®¹æ€§æ–¹æ³•

æ‰€æœ‰ç°æœ‰çš„åè°ƒå™¨æ–¹æ³•éƒ½å®Œå…¨å…¼å®¹ï¼š

- `coordinate_task_execution()` - ä¸åŸæ–¹æ³•å®Œå…¨ç›¸åŒ
- `register_agent()` - æ™ºèƒ½ä½“æ³¨å†Œ
- `get_conversation_statistics()` - å¯¹è¯ç»Ÿè®¡
- ç­‰ç­‰...

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

```python
#!/usr/bin/env python3
import asyncio
from config.config import FrameworkConfig
from core.centralized_coordinator import CentralizedCoordinator
from agents.real_verilog_agent import RealVerilogDesignAgent
from agents.real_code_reviewer import RealCodeReviewAgent
from extensions import create_test_driven_coordinator

async def main():
    # 1. æ ‡å‡†åˆå§‹åŒ–ï¼ˆå®Œå…¨ä¸å˜ï¼‰
    config = FrameworkConfig.from_env()
    coordinator = CentralizedCoordinator(config)
    
    # æ³¨å†Œæ™ºèƒ½ä½“ï¼ˆå®Œå…¨ä¸å˜ï¼‰
    verilog_agent = RealVerilogDesignAgent(config)
    reviewer_agent = RealCodeReviewAgent(config)
    coordinator.register_agent(verilog_agent)
    coordinator.register_agent(reviewer_agent)
    
    # 2. å‡çº§ä¸ºæµ‹è¯•é©±åŠ¨åŠŸèƒ½ï¼ˆä¸€è¡Œä»£ç ï¼‰
    enhanced_coordinator = create_test_driven_coordinator(coordinator)
    
    # 3. ä½¿ç”¨æµ‹è¯•é©±åŠ¨åŠŸèƒ½
    task = """
    è¯·è®¾è®¡ä¸€ä¸ª32ä½ALUæ¨¡å—ï¼Œæ”¯æŒï¼š
    - åŠ æ³•è¿ç®— (ADD)
    - å‡æ³•è¿ç®— (SUB)
    - é€»è¾‘ä¸ (AND)
    - é€»è¾‘æˆ– (OR)
    - å¼‚æˆ– (XOR)
    
    æµ‹è¯•è¦æ±‚ï¼š
    - æµ‹è¯•å°è·¯å¾„: /home/user/alu_testbench.v
    - å¿…é¡»é€šè¿‡æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹
    - å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œè¯·è‡ªåŠ¨åˆ†æå¹¶è¿­ä»£æ”¹è¿›
    """
    
    result = await enhanced_coordinator.execute_test_driven_task(
        task_description=task,
        testbench_path="/home/user/alu_testbench.v"
    )
    
    # 4. å¤„ç†ç»“æœ
    if result["success"]:
        print(f"âœ… ç»è¿‡ {result['total_iterations']} æ¬¡è¿­ä»£ï¼Œæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼")
        print(f"æœ€ç»ˆè®¾è®¡: {result['final_design']}")
    else:
        print(f"âŒ ç»è¿‡ {result['total_iterations']} æ¬¡è¿­ä»£ä»æœ‰é—®é¢˜")
        print(f"è¯¦ç»†åˆ†æ: {result.get('error', 'æœªçŸ¥é”™è¯¯')}")

if __name__ == "__main__":
    asyncio.run(main())
```

## âœ… éªŒè¯ç»“æœ

æˆ‘å·²ç»åˆ›å»ºå¹¶è¿è¡Œäº†å®Œæ•´çš„æ¼”ç¤ºè„šæœ¬ï¼ŒéªŒè¯ç»“æœï¼š

```
ğŸ“Š æ¼”ç¤ºç»“æœ: 5/5 ä¸ªåŠŸèƒ½æ­£å¸¸

ğŸ‰ æ‰€æœ‰åŠŸèƒ½æ¼”ç¤ºæˆåŠŸï¼

ğŸ’¡ å…³é”®ä¼˜åŠ¿:
   âœ… å®Œå…¨å¢é‡ - ä¸ä¿®æ”¹ä»»ä½•ç°æœ‰ä»£ç 
   âœ… é›¶å½±å“ - ç°æœ‰åŠŸèƒ½å®Œå…¨ä¸å—å½±å“  
   âœ… å‘åå…¼å®¹ - æ‰€æœ‰ç°æœ‰APIä¿æŒä¸å˜
   âœ… å¯é€‰ä½¿ç”¨ - æŒ‰éœ€å¯ç”¨æ–°åŠŸèƒ½
   âœ… æ˜“äºé›†æˆ - ä¸€è¡Œä»£ç å®Œæˆå‡çº§
```

## ğŸ”§ é…ç½®é€‰é¡¹

### TestDrivenConfig

```python
@dataclass
class TestDrivenConfig:
    max_iterations: int = 5           # æœ€å¤§è¿­ä»£æ¬¡æ•°
    enable_deep_analysis: bool = True # å¯ç”¨æ·±åº¦é”™è¯¯åˆ†æ
    auto_fix_suggestions: bool = True # è‡ªåŠ¨ç”Ÿæˆä¿®å¤å»ºè®®
    save_iteration_logs: bool = True  # ä¿å­˜è¿­ä»£æ—¥å¿—
    timeout_per_iteration: int = 300  # æ¯æ¬¡è¿­ä»£è¶…æ—¶ï¼ˆç§’ï¼‰
```

### ä½¿ç”¨è‡ªå®šä¹‰é…ç½®

```python
custom_config = TestDrivenConfig(
    max_iterations=3,        # å‡å°‘åˆ°3æ¬¡è¿­ä»£
    timeout_per_iteration=600  # å¢åŠ åˆ°10åˆ†é’Ÿè¶…æ—¶
)

enhanced_coordinator = TestDrivenCoordinator(coordinator, custom_config)
```

## ğŸ‰ ç«‹å³å¼€å§‹ä½¿ç”¨

### æ­¥éª¤1ï¼šå¤åˆ¶æ‰©å±•æ¨¡å—

å°† `extensions/` ç›®å½•å¤åˆ¶åˆ°æ‚¨çš„é¡¹ç›®ä¸­ï¼Œæ— éœ€ä¿®æ”¹ä»»ä½•ç°æœ‰æ–‡ä»¶ã€‚

### æ­¥éª¤2ï¼šé›†æˆä½¿ç”¨

```python
from extensions import create_test_driven_coordinator

# å‡çº§ç°æœ‰åè°ƒå™¨ï¼ˆä¸€è¡Œä»£ç ï¼‰
enhanced_coordinator = create_test_driven_coordinator(your_existing_coordinator)

# ç«‹å³ä½¿ç”¨æ–°åŠŸèƒ½
result = await enhanced_coordinator.execute_test_driven_task(
    "æ‚¨çš„è®¾è®¡éœ€æ±‚ + æµ‹è¯•å°è·¯å¾„"
)
```

### æ­¥éª¤3ï¼šäº«å—æ™ºèƒ½åŒ–å¼€å‘

- ğŸ¤– **è‡ªåŠ¨ä»»åŠ¡è¯†åˆ«**ï¼šç³»ç»Ÿè‡ªåŠ¨åˆ¤æ–­æ˜¯å¦éœ€è¦æµ‹è¯•é©±åŠ¨
- ğŸ”„ **æ™ºèƒ½è¿­ä»£ä¼˜åŒ–**ï¼šæµ‹è¯•å¤±è´¥æ—¶è‡ªåŠ¨æ”¹è¿›è®¾è®¡
- ğŸ” **æ·±åº¦é”™è¯¯åˆ†æ**ï¼šæä¾›å…·ä½“çš„ä¿®å¤å»ºè®®
- ğŸ“Š **å®Œæ•´å¯è¿½æº¯**ï¼šä¿å­˜æ¯æ¬¡è¿­ä»£çš„è¯¦ç»†è®°å½•

## ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“

| ç‰¹æ€§ | ä¼ ç»Ÿæ–¹å¼ | æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ |
|------|----------|----------------|
| **ä»£ç ä¿®æ”¹** | éœ€è¦ä¿®æ”¹ç°æœ‰ä»£ç  | âœ… é›¶ä»£ç ä¿®æ”¹ |
| **å…¼å®¹æ€§** | å¯èƒ½ç ´åç°æœ‰åŠŸèƒ½ | âœ… å®Œå…¨å‘åå…¼å®¹ |
| **é›†æˆéš¾åº¦** | å¤æ‚çš„é›†æˆå·¥ä½œ | âœ… ä¸€è¡Œä»£ç é›†æˆ |
| **ä½¿ç”¨æ–¹å¼** | å¼ºåˆ¶å‡çº§ | âœ… æŒ‰éœ€å¯é€‰ä½¿ç”¨ |
| **æµ‹è¯•é©±åŠ¨** | æ‰‹åŠ¨å¤„ç† | âœ… è‡ªåŠ¨è¿­ä»£ä¼˜åŒ– |
| **é”™è¯¯åˆ†æ** | åŸºç¡€é”™è¯¯ä¿¡æ¯ | âœ… æ™ºèƒ½æ·±åº¦åˆ†æ |

## ğŸš€ æ€»ç»“

è¿™ä¸ªè§£å†³æ–¹æ¡ˆå®Œç¾å®ç°äº†æ‚¨çš„æ‰€æœ‰éœ€æ±‚ï¼š

1. **âœ… ç”¨æˆ·å¯ä»¥æŒ‡å®šæµ‹è¯•å°è·¯å¾„**
2. **âœ… æµ‹è¯•å¤±è´¥æ—¶è‡ªåŠ¨è¿­ä»£åˆ†ææ”¹è¿›**
3. **âœ… å®Œå…¨å¢é‡å®ç°ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½**
4. **âœ… æ™ºèƒ½åŒ–ç¨‹åº¦é«˜ï¼Œç”¨æˆ·ä½“éªŒä¼˜ç§€**

**æœ€é‡è¦çš„æ˜¯ï¼šè¿™æ˜¯ä¸€ä¸ªå®Œå…¨å®‰å…¨çš„å‡çº§ï¼æ‚¨å¯ä»¥ç«‹å³å¼€å§‹ä½¿ç”¨ï¼Œå¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œéšæ—¶å¯ä»¥åœç”¨æ‰©å±•åŠŸèƒ½ï¼Œç°æœ‰ç³»ç»Ÿå®Œå…¨ä¸å—å½±å“ã€‚** 

ğŸ¯ **ç«‹å³å¼€å§‹ä½“éªŒæ™ºèƒ½åŒ–çš„æµ‹è¯•é©±åŠ¨å¼€å‘å§ï¼**